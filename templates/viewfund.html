{% extends 'base.html' %}

{% block content_calendar %}
  {%include "snippets/v.html"%}

{% endblock content_calendar %}
{% load crispy_forms_tags %}

{%block content_sidebar%}
{% include 'snippets/nav_sidebar.html' %}

<div id="content">

  <nav class="navbar navbar-inverse">
      <div class="navbar-header">
          <button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn">
              <i class="glyphicon glyphicon-align-justify" style= "height:100px"></i>
              <span> Menu </span>
          </button>
        </div>
    </nav>
{% block content %}

<h2> {{fund}}</h2>

<canvas id="myChart" width="600" height="400"></canvas>

</div>

{% endblock content %}
{%endblock%}

{% block javascript %}
<script>
$(document).ready(function(){
  var ctx = document.getElementById("myChart").getContext('2d');
  var fundname = '/api/charts/%s'
  var endpoint = fundname.replace('%s', "{{fund}}")

var labels = [];
var fund_data = [];

  $.ajax({
      method: 'GET',
      url: endpoint,
      success: function(data){
        console.log(data);
        labels = data.labels;
        fund_data = data.fund_data;
        console.log(fund_data);
        console.log(labels);
        viewChart(data)
      },
      error: function(error_data){

      }

  })

function viewChart(response_data){
  var myChart = new Chart(ctx, {
    responsive: true,
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Balance',
            data: fund_data,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
          }
      }
  });
}



    $('#sidebarCollapse').on('click', function () {
        $('#sidebar').toggleClass('active');
    });
});
</script>
{% endblock %}
