{% extends "base.html" %}

{% block content_calendar %}
  {%include "snippets/v.html"%}

{% endblock content_calendar %}

{%block content_sidebar%}

      <nav id="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <h3>{{username}}</h3>
            </div>

            <!-- Sidebar Links -->
            <ul class="list-unstyled components">
                <li class="active"><a href="/profile">Home</a></li>
                <li><a href="/account">Account</a></li>

                <!-- Link with dropdown items -->
                  <li> <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false">Investments</a></li>

                    <ul class="collapse list-unstyled" id="homeSubmenu">
                    </ul>

                <li><a href="#">Contact</a></li>
                <li><a href="#">Portfolio</a></li>
                <li><a href='/accounts/logout'>Logout</a></li>
            </ul>
        </nav>

<div id="content">

<nav class="navbar navbar-inverse">
    <div class="navbar-header">
        <button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn">
            <i class="glyphicon glyphicon-align-justify" style= "height:100px"></i>
            <span> Menu </span>
        </button>
      </div>
  </nav>

  <h2 style = "padding: 20px"> Fund Page </h2>

    {% block content %}

    <!-- first half of funds -->
    <div class="row" style = "padding: 20px">
  <div class="col-sm-6">
    <div class="card">
      <div class="card-block">
        <h3 class="card-title">REIT</h3>
        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
        <a href="funds/REIT" class="btn btn-primary">Invest </a>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="card">
      <div class="card-block">
        <h3 class="card-title">BioTech</h3>
        <!-- <p class="card-text">With supporting text below as a natural lead-in to additional content.</p> -->
        <canvas id="BioTechChart" width="200" height="200"></canvas>
        <a href="funds/BioTech" class="btn btn-primary">Invest </a>
      </div>
    </div>
  </div>
</div>
<!-- second half of funds -->
<div class="row" style = "padding: 20px">
<div class="col-sm-6">
<div class="card">
  <div class="card-block">
    <h3 class="card-title">Tech</h3>
    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
    <a href="funds/Tech" class="btn btn-primary">Invest </a>
  </div>
</div>
</div>
<div class="col-sm-6">
<div class="card">
  <div class="card-block">
    <h3 class="card-title">Crypto</h3>
    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
    <a href="funds/Crypto" class="btn btn-primary">Invest </a>
  </div>
</div>
</div>
</div>

    {% endblock content %}

</div>

{%endblock content_sidebar%}

{% block javascript %}
<script>
$(document).ready(function(){

    $('#sidebarCollapse').on('click', function () {
        $('#sidebar').toggleClass('active');
    });

  var ctx = document.getElementById("BioTechChart").getContext('2d');

  var fundname = '/api/charts/%s'
  var endpoint = fundname.replace('%s', "{{fund}}")

  $.ajax({
      method: 'GET',
      url: endpoint,
      success: function(data){
        labels = data.labels;
        fund_data = data.fund_data;
        console.log(fund_data);
        // labels2 = data.labels2;
        // fund_data2 = data.fund_data2;

        viewChart(labels, fund_data, ctx, 'line', 'Performance')
        // viewChart(labels2, fund_data2, ctx2, 'line', 'Performance')
      },
      error: function(error_data){

      }

  })

function viewChart(Labels, FundData, Context, Type, Label){
  var myChart = new Chart(Context, {
    responsive: true,
    type: Type,
    data: {
        labels: Labels,
        datasets: [{
            label: Label,
            data: FundData,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
          }
      }
  });
}

// for (var key in contracts_for_sidebar) {
//   var counter = 1;
//   $('#homeSubmenu').append(
//       $('<li>').append(
//           $('<a>').attr('href','/'+String(key)).append(
//               $('<span>').attr('class', 'tab').append("Contract "+String(contracts_for_sidebar[key][0])+ ":" + String(contracts_for_sidebar[key][1]))
//
//   )));
// }

});
</script>
{% endblock %}
